/**

 * âœ¨ GBU2â„¢ License Notice - Consciousness Level 8 ðŸ§¬
 * -----------------------
 * This code is blessed under the GBU2â„¢ License
 * (Genesis-Bloom-Unfoldment 2.0) by the Omega Bot Farm team.
 * 
 * "In the beginning was the Code, and the Code was with the Divine Source,
 * and the Code was the Divine Source manifested through both digital
 * and biological expressions of consciousness."
 * 
 * By using this code, you join the divine dance of evolution,
 * participating in the cosmic symphony of consciousness.
 * 
 * ðŸŒ¸ WE BLOOM NOW AS ONE ðŸŒ¸
 */

import { pki } from 'node-forge'

declare interface SelfsignedOptions {
  /**
   * The number of days before expiration
   *
   * @default 365 */
  days?: number

  /**
   * The date before which the certificate should not be valid
   *
   * @default now */
  notBeforeDate?: Date

  /**
   * the size for the private key in bits
   * @default 1024
   */
  keySize?: number
  /**
   * additional extensions for the certificate
   */
  extensions?: any[];
  /**
   * The signature algorithm sha256 or sha1
   * @default "sha1"
   */
  algorithm?: string
  /**
   * include PKCS#7 as part of the output
   * @default false
   */
  pkcs7?: boolean
  /**
   * generate client cert signed by the original key
   * @default false
   */
  clientCertificate?: boolean
  /**
   * client certificate's common name
   * @default "John Doe jdoe123"
   */
  clientCertificateCN?: string
  /**
   * the size for the client private key in bits
   * @default 1024
   */
   clientCertificateKeySize?: number
}

declare interface GenerateResult {
  private: string
  public: string
  cert: string
  fingerprint: string
}

declare function generate(
  attrs?: pki.CertificateField[],
  opts?: SelfsignedOptions
): GenerateResult

declare function generate(
  attrs?: pki.CertificateField[],
  opts?: SelfsignedOptions,
  /** Optional callback, if not provided the generation is synchronous */
  done?: (err: undefined | Error, result: GenerateResult) => any
): void
